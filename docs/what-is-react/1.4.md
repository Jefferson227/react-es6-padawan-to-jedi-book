# Como React resolve o problema?

A solução do React para manipulações no DOM, que por sinal são bem caras, é o DOM Virtual. O DOM Virtual é uma representação leve do DOM real. O DOM Virtual é uma representação em memória de DOM real no React. O DOM Virtual clona o DOM real e está disponível como um grande e único objeto JavaScript. Em React, uma vez que o aplicativo é carregado, então a partir do DOM real é criado a representação do DOM Virtual.
<!--
React’s solution for expensive DOM manipulations is DOM Virtual. V-DOM is a lightweight representation of the real DOM. V-DOM is more like a fake DOM. It’s an in memory representation of real DOM within React.JS. V-DOM clones real DOM and it’s available as a large, single JavaScript object. In React once the application loads, it takes the real DOM and creates the representation of V-DOM.-->

### O que é o DOM?

Antes de começar a falar sobre o DOM virtual, vamos falar um pouco sobre o básico - o DOM original.

DOM significa `Document Object Model`. É uma maneira de representar um documento estruturado através de objetos. É uma convenção multi-plataforma e independente de linguagem para representar e interagir com dados em HTML, XML e outros. Os navegadores da Web manipulam os detalhes de implementação do DOM, para que possamos interagir com ele usando JavaScript e CSS. Podemos procurar por nós e mudar seus detalhes, remover um e inserir um novo.

Atualmente, a API DOM é quase cross-platform e cross-browser. Então, qual é o problema com isso?

#### Problema do DOM

O principal problema é que o DOM nunca foi otimizado para criar UI dinâmico.

Podemos trabalhar com ele usando JavaScript e bibliotecas como o jQuery. Mas jQuery e outros fizeram pouco para resolver problemas de desempenho. Pense nas redes sociais modernas, como Twitter, Facebook ou Pinterest. Depois de deslizar um pouco, o usuário terá dezenas de milhares de nós. Interagir com eles de forma eficiente é um grande problema. Tente mover 5 pixel de 1000 divs por exemplo. Pode demorar mais de um segundo. É muito tempo para a web moderna. Você pode otimizar o script e usar alguns truques, mas no final, é uma dor trabalhar com páginas enormes e UI dinâmicas.

<!--What is DOM?

Before we start to discover the DOM Virtual technology let’s talk a little bit about the basic thing — the original DOM.

DOM stands for Document Object Model. It’s a way of representing a structured document via objects. It is cross-platform and language-independent convention for representing and interacting with data in HTML, XML, and others. Web browsers handle the DOM implementation details, so we can interact with it using JavaScript and CSS. We can search for nodes and change their details, remove one and insert a new one.

This days DOM API is almost cross-platform and cross-browser.
So what’s the problem with it?
DOM Problem

The main problem is that DOM was never optimized for creating dynamic UI.

We can work with it using JavaScript and libraries like jQuery (thank God we have it). But jQuery and others did little to solve performance issues. Think about modern social networks like Twitter, Facebook or Pinterest. After scrolling a little bit, the user will have tens of thousands of nodes. Interact with them efficiently is a huge problem. Try to move a 1000 divs 5 pixel left for example. It may take more than a second. It’s a lot of time for the modern web. You can optimize the script and use some tricks, but in the end, it’s a pain to work with huge pages and dynamic UI.-->

### DOM virtual

Ao invés de tocar o DOM diretamente, estamos construindo uma versão abstrata do mesmo. Trabalhamos com algum tipo de cópia leve de nosso DOM. Podemos mudá-lo como quisermos e, em seguida, salvar em nossa árvore de DOM real. Enquanto salvamos, devemos comparar, encontrar a diferença e mudar (re-renderizar) o que deve ser alterado.

É muito mais rápido do que trabalhar diretamente com DOM, porque não exige todas as peças de peso pesado que entram em um DOM real. Podemos ilustrar o que acontece da seguinte maneira:

<!--Virtual DOM

Rather than touching the DOM directly, we’re building an abstract version of it. That’s it. We working with some kind of lightweight copy of our DOM. We can change it as we want and then save to our real DOM tree. While saving we should compare, find difference and change (re-render) what should be changed.

It is much faster than working directly with DOM, because it doesn’t require all the heavyweight parts that go into a real DOM.-->

![](/images/virtualDOM.PNG)

Conforme pode ver na imagem acima, nossa vai ser renderizada e no final teremos um árvove de elementos (DOM real). O React cria um DOM Virtual (In-memory DOM na figura) a partir de nosso DOM real. Perceba que a manipulação do estado de nossa aplicação é feita interiamente com o DOM Virtual. Quando o React percebe que aalgo precisa ser atualizado, conforme aquele nó vermelho no DOM virtual, ele executa um algoritmo de diff para poder atualizar no DOM real somente o que for necessário. Essa abordagem é muito rápida e eficaz.
<!--
Com o React os desenvolvedores geralmente usam JSX, que tem uma sintaxe parecida com HTML. Para nosso carrinho de compras, o JSX
pode acabar ficando assim:

```html
<ul>
  {
    this.props.items.map(function(item) {
      return (<li key={item}>{item}</li>);
    })
  }
</ul>
```

Não se preocupe com a sintaxe ou se não entendeu esse código. Mais na frente iremos detalhar cada aspecto que podemos ver nesse código, desde o que é esse JSX a esse atributo props.

Sempre que os dados mudarem, o código acima vai ser chamado novamente. Podemos comparar essa chamada com a que pensamos em fazer para renderizar tudo de novo, mas com uma diferença. O React vai renderizar o que vemos acima para o DOM Virtual primeiro, depois disso ele compara esse DOM Virtual com o verdadeiro DOM, e somente faz a mudança do que for necessário.

No nosso exemplo, se nós adicionarmos `Arroz` na lista e renderizar novamente, o React vai descobrir por conta própria que apenas um único elemento do DOM precisa ser criado e adicionado no final da lista.
React não é a única biblioteca que usa um DOM virtual para resolver este problema, mas é de longe a mais popular.-->

**Então, o que é React?**
Você sabe que o React cria uma maneira simples para os desenvolvedores de JavaScript atualizar o DOM para corresponder com o seu modelo de dados. Isso é tudo que faz!

Se você quiser uma descrição de uma linha:
React é uma biblioteca JavaScript que pemite atualizações rápidas de DOM por meio de um 'DOM virtual'.

**É isso?** Sim! Essa é a essência do que o React realmente é. A maioria dos outros recursos que você pode associar ao React realmente ocorre em outras bibliotecas: armazenamento de dados, roteamento e rede. Nada disso acontece em React.

Desanime não pequeno Padawan. Esse é apenas o começo de nossa jornada rumo a maestria Jedi. Estás prestes a mudar sua carreira com o que vamos aprender nesse livro.